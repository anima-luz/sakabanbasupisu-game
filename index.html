<!DOCTYPE html>
<html>
<head>
    <title>Card Game with Rooms</title>
    <style>
        #game {
            text-align: center;
        }
        #result {
            font-size: 24px;
        }
        .card {
            border: 2px solid black;
            padding: 10px;
            margin: 5px;
            cursor: pointer;
        }
        #room {
            display: none;
        }
    </style>
</head>
<body>
<div id="game">
    <h1>Card Game</h1>
    <div id="room">
        <h2>Your Room ID: <span id="roomID"></span></h2>
    </div>
    <button onclick="createRoom()">Create a Room</button>
    <button onclick="joinRoom()">Join a Room</button>
    <div id="cardSelection">
        <h2>Select a card:</h2>
        <div class="card" onclick="chooseCard('サカ')">サカ</div>
        <div class="card" onclick="chooseCard('バン')">バン</div>
        <div class="card" onclick="chooseCard('バス')">バス</div>
        <div class="card" onclick="chooseCard('ピス')">ピス</div>
        <button onclick="lockInCard()">決定</button>
    </div>
    <div id="result"></div>
</div>

<script>
    let players = [];
    let cards = ["サカ", "バン", "バス", "ピス"];
    let king = 0;
    let currentPlayer = 0;
    let roomID = null;

    function createRoom() {
        roomID = Math.random().toString(36).substr(2, 6);
        document.getElementById("roomID").textContent = roomID;
        document.getElementById("room").style.display = "block";
        players.push("Player 1");
    }

    function joinRoom() {
        roomID = prompt("Enter the Room ID:");
        if (roomID) {
            document.getElementById("roomID").textContent = roomID;
            document.getElementById("room").style.display = "block";
            players.push("Player 2");
            players.push("Player 3");
            players.push("Player 4");
            players.push("Player 5");
        }
    }

    function chooseCard(card) {
        if (players.includes(`Player ${currentPlayer + 1}`) && players[currentPlayer] === `Player ${currentPlayer + 1}`) {
            if (players[currentPlayer] === `Player ${king + 1}`) {
                alert("You are the KING. You cannot choose a card.");
            } else {
                if (players[currentPlayer].card === null) {
                    players[currentPlayer].card = card;
                    document.getElementsByClassName("card")[cards.indexOf(card)].style.display = "none";
                } else {
                    alert("You have already chosen a card.");
                }
            }
        } else {
            alert("It's not your turn to choose a card.");
        }
    }

    function lockInCard() {
        if (players.includes(`Player ${currentPlayer + 1}`) && players[currentPlayer] === `Player ${currentPlayer + 1}`) {
            if (players[currentPlayer].card === null) {
                alert("You must choose a card before locking in.");
            } else {
                currentPlayer++;
                if (currentPlayer === 4) {
                    // All players have locked in their cards
                    document.getElementById("cardSelection").style.display = "none";
                    revealCards();
                }
            }
        } else {
            alert("It's not your turn to lock in the card.");
        }
    }

    function revealCards() {
        let resultText = "Results:<br>";

        for (let i = 0; i < players.length; i++) {
            resultText += `<b>${players[i]}:</b> ${players[i].card}<br>`;
        }

        if (players[0].card === "サカ" && players[1].card === "バン" && players[2].card === "バス" && players[3].card === "ピス") {
            resultText += "You WIN!!";
        } else {
            resultText += "You LOST......";
        }

        document.getElementById("result").innerHTML = resultText;
    }
</script>
</body>
</html>
